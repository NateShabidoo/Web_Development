// QUALIFIER - most of the aesthetics of this page was done by the graphic designer (I created the working page with the old site style and the designer updated aesthetics later) 

<?php
session_start();
require 'database/config.php';
ob_start();

 ?>

<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
<title>Login Page</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" integrity="sha512-HK5fgLBL+xu6dm/Ii3z4xhlSUyZgTT9tuc/hSrtw6uzJOvgRr2a9jyxxT1ely+B+xFAmJKVSTbpM/CuL7qxO8w==" crossorigin="anonymous"/>

        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:400,700">
        
        <link href="test.css?v=<?php echo time(); ?>" rel="stylesheet">
        <link href="style/ui.css?v=<?php echo time(); ?>" rel="stylesheet">

        <style>
            body {
            font-family: "Poppins", serif;
            }
        </style>

    </head>
    
    
    <body>
        <div class="logo">
            <a href="index_ui.php" style="display: flex; align-items: center">
                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-bar-chart-fill" viewBox="0 0 16 16">
                    <path d="M1 11a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3zm5-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm5-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V2z"/>
                </svg>
                <div class="logo-text">SimpleChartsRI</div>
            </a>
        </div>
	<div class="form-container sign-in-container">
	<form class="myform" action="login2.php" method="POST">
	    <div class="H1">Wecome back!</div>
	    <br>
		<div class="P">Email</div>
		<input name="username" type="text" class="inputvalues" placeholder="Type your email" required/>
		<br>
		<div class="P">Password</div>
		<input name="password" type="password" class="inputvalues" placeholder="Type your password" required/>
		<div style="height: 45px; display: flex; justify-content: center; flex-direction: column;">
		    <a href="resetpassword_ui.php" id="reset_password">Forgot Password?</a>
		</div>

		<input name="login" type="submit" id="login_btn" value="Log in"/>
		
		<div style="height: 45px; display: flex; justify-content: center; flex-direction: column; text-align: center;">
		    <a href="register_ui.php">Don't have an account? Register here.</a>		
		</div>
		

	</form>
	
    <?php if(isset($_POST['login']))
			{ 
				$username = $_POST['username'];
				$password = $_POST['password'];
				$encrypted_password = md5($password);
				$encrypted_username = md5($username);
				$_SESSION['username'] = $username; //$_POST['username'];

				$query = "select * from users WHERE username='$username' AND password='$encrypted_password'";

				$query_run = mysqli_query($conn, $query);

					if(mysqli_num_rows($query_run)>0)
					            {
									header('location:main3.php');
								}
								else
								{
									//invalid
									echo '<script type="text/javascript">alert("Invalid credentials")</script>';
								}
			}
						?>
	</div>

    </body>
    
</html>
